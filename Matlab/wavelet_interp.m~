function [TDPhase] =  wavelet_interp(TDSignal, DT, Graphic)
%%
dj=0.05; %wavelet interval
J1=127; %total # of scales
pad=1; %zero-pad signals
s0=2*DT; %set initial scale
mother='Morlet'; %wavelet shape
param=6; %initial wavelet order

%computes the wavelets
[WN,Period,~] = wavelet(TDSignal,DT,pad,dj,s0,J1,mother,param);
Power = abs(WN).^2;
Freqs=1./(1.033.*Scale);
if Graphic
    figure(1);clf;
   mesh(Time, Period, Power) 
   view(45,90);
end
%%
freq=1./(1.033*scales);
Power = abs(WN).^2;

siz = size(Power,2);

for k = 1:siz
    [~,idx(k)] = max(power(:,k));
    phase_max(k) = angle(WN(idx(k),k));
end
phase_max_u = unwrap(phase_max)';
phase_max_w = wrapToPi(phase_max_u)';

wi = (diff(phase_max_u).*2*2/pi)';
end